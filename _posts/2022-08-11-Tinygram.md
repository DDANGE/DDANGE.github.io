---
title:  "Tinygram"
classes: wide
date: 2022-08-11 18:00:00 +0900
author: ddange
categories : [Project]
tags: [Content Design]
author_profile: "ddange"
toc: true
toc_label: "Content Design"
toc_icon: "align-justify"
---

# íƒ€ì´ë‹ˆê·¸ë¨ ì»¨í…ì¸  ì„œë²„ ë””ìì¸

### ğŸ”· ì„ ë¬¼í•˜ê¸°

1. ì„ ë¬¼ë¦¬ìŠ¤íŠ¸ 
    - UT_GiftList í…Œì´ë¸”ì¶”ê°€
    - Column : Idx, UserIDX, ItemIDX, Count
2. ì„ ë¬¼í•˜ê¸° íšŸìˆ˜ ì„œë²„ê´€ë¦¬ 
    - UT_Resource í…Œì´ë¸” Columnì¶”ê°€ -> GiftCount

3. ì„ ë¬¼êµ¬ë§¤ (ë‹¤ì´ì•„) 
4. ì„ ë¬¼í•˜ê¸° íšŸìˆ˜ êµ¬ë§¤(ë‹¤ì´ì•„)

---
### ğŸ”· ë­í‚¹
Redis í™œìš© 
Sorted Set
Collection = relation_{0} = MemberIDX
Key = UserIDX
Value = relationPoint - ì£¼ë§ˆë‹¤ ì´ˆê¸°í™”

1. í˜¸ê°ë„
2. ë©¤ë²„ë³„ ë­í‚¹ë³´ë“œ (7ê°œ)
4. ì£¼ë§ˆë‹¤ ì´ˆê¸°í™”

---
### ğŸ”¹ ë­í‚¹ì§‘ê³„
 * Linux Clon í™œìš©
 
 1. 1ì£¼ì¼ ì£¼ê¸°
    - ë­í‚¹ì§‘ê³„ 
    - ë³´ìƒìš°í¸ ë°œì†¡
 2. ë§¤ì¼ ì£¼ê¸°
    - ì„ ë¬¼ ê°€ëŠ¥ íšŸìˆ˜ ë¦¬ì…‹
---

# Protocol
1ï¸âƒ£ **GetTinygramInfo** íƒ€ì´ë‹ˆê·¸ë¨ ì •ë³´ ìš”ì²­ 
* ê°œì¸ë­í‚¹ ì •ë³´
    - ìˆœìœ„, ì£¼ê°„ í˜¸ê°ë„ í¬ì¸íŠ¸
* ë©¤ë²„ë³„ 1~10ìœ„ ìœ ì € ëª©ë¡ 
    - ìˆœìœ„, ìœ ì €ë‹‰ë„¤ì„, í˜¸ê°ë„í¬ì¸íŠ¸

Request
```json
{
	"id": "eae7c783",
	"method" : 1000,
	"params" : {},
	"sess" : "ce3ad94c7971c62a7de3718b2fde66f31463e1a0e1122865a0801583"
}
```

Response
```json
{
	"id": "eae7c783",
	"result":{
		"rankingList" : [
							{
							    "memberIDX" : 1,
							    "rank" : [
										    {
											    "userNick" : "name",
											    "relPoint" : 100
										    },
										    {
											"userNick" : "name",
											"relPoint" : 80
										    }	
									    ]
							},
							{
							    "memberIDX" : 2,
							    "rank" : [
										    {
											    "userNick" : "name",
											    "relPoint" : 100
										    },
										    {
											"userNick" : "name",
											"relPoint" : 80
										    }
									    ]
							}
                        
						 ],
		"myRaking" : [
                        {
                            "memberIDX" : 1,
                            "myRank" : 1,
                            "relationPoint" : 1000		
                        },
                        {
                            "memberIDX" : 2,
                            "myRank" : 1,
                            "relationPoint" : 1000		
                        },
                        {
                            "memberIDX" : 3,
                            "myRank" : 1,
                            "relationPoint" : 1000		
                        }
                 
		],
		"GiftChance" : 7
	},
	"server_time" : 1648091997
}
```
	
	* Response Data 
		1. ê° ë§´ë²„ë³„ ë­í‚¹ ìˆœìœ„ 1~10ìœ„
		2. í˜„ì¬ ìœ ì € ë©¤ë²„ë³„ í˜¸ê°ë„ 
		3. ì„ ë¬¼ ê°€ëŠ¥ íšŸìˆ˜
	


<br><br><br>

2ï¸âƒ£ **SendGift** ì„ ë¬¼ë³´ë‚´ê¸°
Request
```json
{
	"id": "eae7c783",
	"method" : 1000,
	"params" : { 
		"ItemIDX" : 1
	},
	"sess" : "ce3ad94c7971c62a7de3718b2fde66f31463e1a0e1122865a0801583"
}
```

Response
```json
{
	"id: "eae7c783",
	"result":{
		"res" : true,
	}
	"server_time" : 1648091997
}
```

<br><br><br>

3ï¸âƒ£ **BuyGift** ì„ ë¬¼êµ¬ë§¤
Request
ItemIDX = ST_Item -> Idx 
```json
{
	"id": "eae7c783",
	"method" : 1000,
	"params" : { 
		"ItemIDX" : 1,
		"cnt" : 10
	},
	"sess" : "ce3ad94c7971c62a7de3718b2fde66f31463e1a0e1122865a0801583"
}
```

Response
```json
{
	"id: "eae7c783",
	"result":{
		"res" : true,
	}
	"server_time" : 1648091997
}
```
<br><br><br>

4ï¸âƒ£ **BuyGiftChance** ì„ ë¬¼í•˜ê¸° íšŸìˆ˜ êµ¬ë§¤
Request
```json
{
	"id": "eae7c783",
	"method" : 1000,
	"params" : { 
		"cnt" : 3,
	},
	"sess" : "ce3ad94c7971c62a7de3718b2fde66f31463e1a0e1122865a0801583"
}
```

Response
```json
{
	"id: "eae7c783",
	"result":{
		"res" : true,
	}
	"server_time" : 1648091997
}
```

<br><br><br>

# ì‹œìŠ¤í…œ í…Œì´ë¸”
1. **ST_Relation**  (ë©¤ë²„ë³„ í˜¸ì¹­ê³¼ í•„ìš” ê´€ê³„í¬ì¸íŠ¸)
    * Idx - int - ê³ ìœ ê°’
    * Member - int - ë©¤ë²„ë²ˆí˜¸  
    * RelationName - int - ê´€ê³„í˜¸ì¹­
    * ReqRelationPoint - int - í•„ìš” ê´€ê³„ í¬ì¸íŠ¸
    * ProfileText - int - ê²Œì‹œê¸€
---
2. **ST_Picture** (ë©¤ë²„ë³„ ì‚¬ì§„ í…Œì´ë¸”, ì–¸ë½ ì¡°ê±´)
    * Idx â€”int  ê³ ìœ ê°’
    * Name - int - ì‚¬ì§„ì´ë¦„
    * Member - int - ë©¤ë²„ë²ˆí˜¸
    * Image - string - ì‚¬ì§„ ì´ë¯¸ì§€ íŒŒì¼ëª…
    * Type - int - ì‚¬ì§„íƒ€ì… (íšë“ì¡°ê±´íƒ€ì…)
    * ReqUnlockIdx - int - í•´ê¸ˆì¡°ê±´ IDX
    * ReqUnlockValue - int - í•´ê¸ˆì¡°ê±´ ê°’
    * UnlockText - int - í•´ê¸ˆì¡°ê±´ í…ìŠ¤íŠ¸
    * Icon - string - ì‚¬ì§„ìš© ê³µìš© ì•„ì´ì½˜
---
3. **ST_GiftList** (ë©¤ë²„ë“¤ì—ê²Œ ì„ ë¬¼í•  ì•„ì´í…œ ë¦¬ìŠ¤íŠ¸)
    * Idx - int - ê³ ìœ ê°’
    * Sort - int - ìš°ì„ ìˆœìœ„ ì˜¤ë”
    * GiftItemIdx - int - ë¦¬ìŠ¤íŠ¸ ì„ ë¬¼ ì•„ì´í…œ    ???
    * RelationPoint - int - ì„ ë¬¼ì´ ì£¼ëŠ” ê´€ê³„ í¬ì¸íŠ¸
    * SellType - int - íŒë§¤íƒ€ì… (0 = ë¯¸íŒë§¤, 1 = íŒë§¤)
    * PriceType - int - êµ¬ë§¤ ì¬í™” íƒ€ì… (0=ë¯¸íŒë§¤, 1=ë‹¤ì´ì•„, 101=ê´‘ê³ )
    * PriceIdx - int - ì¬í™” ì°¸ê³ í•  ì¸ë±ìŠ¤ ???
    * PriceCnt - int - êµ¬ë§¤ê°€ê²©
---
4. **ST_GiftingList**
    * Idx - int - ê³ ìœ ê°’
    * Sort - int - ë¦¬ìŠ¤íŠ¸ ì •ë ¬ìˆœì„œ
    * Name - int -ì„ ë¬¼íšŸìˆ˜ ìƒí’ˆ ì´ë¦„
    * Icon - string - ì„ ë¬¼íšŸìˆ˜ìƒí’ˆ ì•„ì´ì½˜
    * GiftingBuyCnt - int -  êµ¬ë§¤ì‹œ ì¶©ì „ë˜ëŠ” ì„ ë¬¼ íšŸìˆ˜ 
    * PriceType - int - ì¬í™”íƒ€ì… (1 = ë‹¤ì´ì•„)
    * PriceIdx - int - ì¬í™” ì°¸ê³ í•  ì¸ë±ìŠ¤
    * PriceCnt - int - êµ¬ë§¤ê°€ê²©
---
5. **ST_TinytanDM**
    * Idx - int - ê³ ìœ ê°’
    * Type - int - ë©”ì‹œì§€ íƒ€ì… (1 = 1ìœ„ ë©”ì‹œì§€, 2 = ëœë¤ ë©”ì‹œì§€, 3 = ê´€ê³„ë‹¬ì„± ë©”ì‹œì§€)
    * TypeReferValue - int -  íƒ€ì…ë³„ ì°¸ì¡°ê°’ 
    	â€” (Type = 1,2ë©´ ë©¤ë²„ë²ˆí˜¸, Type = 3ì´ë©´ ST_Relation > Idx)
    * MessageString - int - ë©”ì‹œì§€ í…ìŠ¤íŠ¸
    * RewardGroup - int - ë©”ì‹œì§€ ë³´ìƒ ê·¸ë£¹ 
	â€” (ST_TinygramReward -> RewardGroup)
	â€” í•´ë‹¹í•˜ëŠ” Groupë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸ ì¤‘ì—ì„œ ST_TinygramReward -> Rate í™•ë¥ ë¡œ
            RewardVarietyCntë§Œí¼ ì§€ê¸‰
    * RewardVarietyCnt - int - ë³´ìƒ ì¢…ë¥˜ ê°œìˆ˜
---
6. **ST_Rank**
    * idx - int - ê³ ìœ ê°’
    * RankRangeLow - int - ìˆœìœ„ ë²”ìœ„
    * RankRangeHigh  - int - ìˆœìœ„ ë²”ìœ„
    * RankNotiText - int - ìˆœìœ„ ì•ˆë‚´ í…ìŠ¤íŠ¸
    * RewardGroup - int - ë­í‚¹ ë³´ìƒ ê·¸ë£¹

---
**ê¸°íšì„œ ë²„ì „1.0ì—ì„œ ì‚­ì œ**
-~~6. ST_RankSeason~~- 
-~~* idx - ê³ ìœ ê°’~~-
-~~* RankStartDay - ì‹œì¦Œ ì‹œì‘ì¼ (YYYY/MM/DD hh:mm:ss)~~-
-~~* RankTermDay - ì‹œì¦Œí…€(ì¼)~~-

---
7. **ST_TinygramReward**
    * idx - int -ê³ ìœ ê°’
    * RewardGroup - int - ë³´ìƒ ê·¸ë£¹(ì‹¤ì§ˆì  IDX)
    * RewardType - int - ì¬í™”/ì•„ì´í…œíƒ€ì…
( 1 = ìœ ë£Œë‹¤ì´ì•„, 2 = ë¬´ë£Œë‹¤ì´ì•„, 3 = ìœ ë£Œë½‘ê¸°í‹°ì¼“, 4 = í…Œë§ˆ ìœ ë£Œë½‘ê¸°í‹°ì¼“, 
11 = ê³¨ë“œ, 12 = í•˜íŠ¸, 13 = ë¬´ë£Œë½‘ê¸°í‹°ì¼“, 14 = ê´‘ê³ ìŠ¤í‚µê¶Œ, 50 = ì¹œë°€ë„ì¬ë£Œ, 
101 = ìŠ¤í‚¨ì¹´ë“œ)
    * RewardIdx - int - ì§€ê¸‰ ì¸ë±ìŠ¤(íƒ€ì… 1~50ì€ ST_Item, íƒ€ì… 101ì€ ST_Skin)
    * RewardCnt - int - ì§€ê¸‰ ê°¯ìˆ˜
    * Rate - int - ì§€ê¸‰í™•ë¥  (10000 = 100%)
    * Sort - int - ì •ë ¬ìˆœì„œ
    * GetType - int - ë³´ìƒ íšë“ íƒ€ì… (1=ê°¯ìˆ˜íšë“, 2=ìƒì‚°ëŸ‰íšŒë“)

---
8. **ST_Help** 
	* Idx - int - ê³ ìœ ê°’
	* Content - int - ì»¨í…ì¸ ë¶„ë¥˜ (1 = íƒ€ì´ë‹ˆê·¸ë¨)
	* Type - int - ë¬¸êµ¬íƒ€ì… ( 0 = íƒ€ì´í‹€, 1 = ë¶€ì¬, 2 = ì„¤ëª…)
	* String - int - ìŠ¤íŠ¸ë§ í‚¤ê°’(ë­íŒ©)
	* Sort - int - ì •ë ¬ ìˆœì„œ
---

**ê¸°íšì„œ ë²„ì „1.0ì—ì„œ ì‚­ì œ**
~~8. **ST_RankReward** (ë­í‚¹ ë³´ìƒ ê·¸ë£¹)~~
    ~~* idx - int - ê³ ìœ ê°’~~
    ~~* RewardGroup - int - ë³´ìƒê·¸ë£¹~~
    ~~* RewardType - ì¬í™”/ì•„ì´í…œíƒ€ì…~~ 
    ~~( 1 = ìœ ë£Œë‹¤ì´ì•„, 2 = ë¬´ë£Œë‹¤ì´ì•„, 3 = ìœ ë£Œë½‘ê¸°í‹°ì¼“, 4 = í…Œë§ˆ ìœ ë£Œë½‘ê¸°í‹°ì¼“,~~ 
          ~~11 = ê³¨ë“œ, 12 = í•˜íŠ¸, 13 = ë¬´ë£Œë½‘ê¸°í‹°ì¼“, 14 = ê´‘ê³  ìŠ¤í‚µê¶Œ, 50 = ì¹œë°€ë„ì¬ë£Œ,~~ 
          ~~101 = ìŠ¤í‚¨ì¹´ë“œ)~~
    ~~* RewardIdx - ì§€ê¸‰ ì¸ë±ìŠ¤(íƒ€ì… 1~50ì€ ST_Item, íƒ€ì… 101ì€ ST_Skin)~~
    ~~* RewardCnt - ì§€ê¸‰ ê°¯ìˆ˜~~
    ~~* Rate - ì§€ê¸‰í™•ë¥ (10000 = 100%)~~
    ~~* Sort - ì •ë ¬ìˆœì„œ~~
    ~~* GetType - ë³´ìƒ íšë“ íƒ€ì… (1=ê°¯ìˆ˜íšë“, 2=ìƒì‚°ëŸ‰íšŒë“)~~
---
9. **ST_Define** 
    * MAX_GIFTING_HAVE_COUNT = ì„ ë¬¼ íšŸìˆ˜ ìµœëŒ€ ì¶©ì „ëŸ‰
    * MAX_GIFT_HAVE_COUNT = ì„ ë¬¼ ìµœëŒ€ ë³´ìœ ëŸ‰
    * RANDOM_MESSAGE_TIME01 = ì˜¤ì „ ëœë¤ ë©”ì‹œì§€ ë°œì‹  íƒ€ì„01 (9ì‹œ)
    * RANDOM_MESSAGE_TIME02 = ì €ë… ëœë¤ ë©”ì‹œì§€ ë°œì‹  íƒ€ì„02 (20ì‹œ)
    * RANK_SEASON_DAY = ì‹œì¦Œ ì‹œì‘ ìš”ì¼ (0 = ì¼ìš”ì¼, 1 = ì›”ìš”ì¼, 2 = í™”ìš”ì¼â€¦)
    * IMAGE_UPLOAD_DATE = ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°í•œ (ë‹¨ìœ„:ì¼)
    * RANK_CHECK_TIME = ë­í¬ ì§‘ê³„ ì‹œê°„ (ë‹¨ìœ„:ë¶„)
    * GAME_RESET_TIME =  ê°±ì‹  íƒ€ì„ 
---



<br><br>
â—ï¸ **ê°¤ëŸ¬ë¦¬ ì—…ë¡œë“œ ê¸°ëŠ¥**  ì¶”í›„ í™•ì¸ í•„ìš” 
